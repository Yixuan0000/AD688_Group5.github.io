---
title: "Multiple Linear Regression - Salary Predition"
subtitle: ""

bibliography: references.bib
csl: csl/econometrica.csl
format: 
  html:
    toc: true
    number-sections: true
    df-print: paged
    code: false
    code-tools: true
    section-divs: true
---

```{python}
import pandas as pd
import numpy as np
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score

```

```{python}
df = pd.read_csv('files/cleaned_job_postings.csv')
```

```{python}
df.head()
df.columns
```

```{python}
df["exp_mid"] = df[["MIN_YEARS_EXPERIENCE", "MAX_YEARS_EXPERIENCE"]].mean(axis=1)

df["skill_count"] = df["SPECIALIZED_SKILLS_NAME"].fillna("").str.count(",") + 1

df["has_python"] = df["SPECIALIZED_SKILLS_NAME"].str.contains("Python", case=False, na=False).astype(int)

df["edu_ge_bachelors"] = df["MIN_EDULEVELS_NAME"].isin(
    ["Bachelor's Degree", "Master's Degree", "Doctoral Degree"]
).astype(int)

keep_num  = ["exp_mid", "MODELED_DURATION", "skill_count",
             "has_python", "edu_ge_bachelors"]

keep_cat  = ["EMPLOYMENT_TYPE_NAME", "REMOTE_TYPE_NAME",
             "STATE_NAME", "LIGHTCAST_SECTORS_NAME",
             "SOC_2021_4_NAME", "TITLE_CLEAN"]

df_model = df.dropna(subset=["SALARY"])[keep_cols + ["SALARY"]]
```

```{python}
df_dummies = pd.get_dummies(
    df_model,
    columns = keep_cat,   
    drop_first = True,   
    dtype = float        
)
```


```{python}
print(df_dummies.shape)
print(df_dummies.dtypes.head(10))
```

```{python}
# Drop salary to form features
X = df_dummies.drop('SALARY', axis = 1)
y = df_dummies['SALARY']

X_train, X_test, y_train, y_text = train_test_split(X, y ,test_size = 0.3, random_state = 688)
```

```{python}
model = LinearRegression()
model.fit(X_train, y_train)
```

```{python}
y_pred = model.predict(X_test)
```

```{python}
```

```{python}
```